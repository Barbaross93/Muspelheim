#!/bin/sh
color="#afb7d2'>"
col="<span color='"
end="</span>"
FULL=""  #"•"
EMPTY="" #"○"
value="${2:-5}"

draw() {
	perc=$1
	size=$2
	inc=$((perc * size / 100))
	out=
	for v in $(seq 0 $((size - 1))); do
		test "$v" -le "$inc" &&
			out="${out}${FULL}" ||
			out="${out}${EMPTY}"
	done
	printf "%s" "$out"
}

case $1 in
up)
	#busctl call org.clightd.clightd /org/clightd/clightd/Backlight org.clightd.clightd.Backlight RaiseAll "d(bdu)s" 0.05 0 0 0 ""
	xbacklight -inc 5
	label=""
	;;
down)
	#busctl call org.clightd.clightd /org/clightd/clightd/Backlight org.clightd.clightd.Backlight LowerAll "d(bdu)s" 0.05 0 0 0 ""
	xbacklight -dec 5
	label=""
	;;
esac

#brightness="$(busctl call org.clightd.clightd /org/clightd/clightd/Backlight org.clightd.clightd.Backlight Get "s" "" | awk '{print $3*100}')"
brightness=$(xbacklight -get)
fullbrightness=${brightness%.*}
bar="$(draw ${fullbrightness} 10)"
printf "SEC:1\tTAG:bright\t$label Brightness\t \t$bar\n" >$XNOTIFY_FIFO
#dunstify -t 3000 -r 2593 -u normal -a brightness -h int:value:$brightness "$label Brightness"
#echo "$brightness" >>/tmp/xoblight
