#!/bin/sh

# media-control is a script that acts like playerctl, but controls MPD
# instead of MPRIS if MPD is active.

#active=$(mpc current | wc -l)
active=$(cmus-remote -Q | wc -l)

# If output is only one line, likely that mpd is actively playing
if [ $active -gt 1 ]; then
	# translate playerctl commands to mpc commands
	case "$1" in
	play-pause)
		#mpc toggle
		cmus-remote -u
		;;
	previous)
		#mpc prev
		cmus-remote -r
		;;
	next)
		#mpc "$@"
		cmus-remote -n
		;;
	stop)
		cmus-remote -s
		;;
	*)
		cmus-remote "$@"
		;;
	esac
elif command -v playerctl >/dev/null; then
	playerctl "$@"
else
	# shellcheck disable=SC2016 # I don't want expansion in this string
	#echo 'mpd is not running, and playerctl is not in your $PATH'
	echo 'cmus is not running, and playerctl is not in your $PATH'
fi
