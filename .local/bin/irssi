#!/usr/bin/env sh

FNOTIFY="$XDG_CONFIG_HOME/irssi/fnotify"

cleanup() {
	rm "$FNOTIFY"
	kill -- -$$
}

[ ! -f "$FNOTIFY" ] && touch "$FNOTIFY"
tail -f "$FNOTIFY" |
	while read line; do
		channel=$(echo "$line" | awk '{print $2}')
		person=$(echo "$line" | cut -d '<' -f2 | cut -d '>' -f1)
		message=$(echo "$line" | awk -F â”‚ '{print $2}')
		notify-send "irssi" "$person in $channel says:\t$message\n"
	done &

# Alias to change home/config dir
/usr/bin/irssi --config="$XDG_CONFIG_HOME"/irssi/config --home="$XDG_CONFIG_HOME"/irssi

cleanup
